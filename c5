from pathlib import Path
from datetime import datetime
import pandas as pd
from pyspark.sql import SparkSession

spark = SparkSession.builder.getOrCreate()

def process_mp3(mp3_path: str):
file_name = Path(mp3_path).name
text = transcribe_mp3(mp3_path, speech_config) # uses Cell 6 function and Cell 5 speech_config
row = {
"filename": file_name,
"transcript": text,
"processed_timestamp": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
"transcript_length": len(text)
}
return spark.createDataFrame(pd.DataFrame([row]))



