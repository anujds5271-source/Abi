# CELL 8: Auto Filename + Custom Table Name

from pathlib import Path

# Your file path
mp3_path = "/Workspace/Users/anuj.b.s@mughalvaren.com/sample-ppt/audio/presentation_script/1_user_say/mygov_1.mp3"

# Get filename automatically
filename = Path(mp3_path).name

# Get real transcript
try:
    transcript = transcribe_mp3_directly(mp3_path)
except:
    transcript = "Transcription failed"

# Create result
result = spark.createDataFrame([(filename, transcript)], ["filename", "transcript"])

# Show it
display(result)

# Save to custom table folder
result.write.mode("append").option("mergeSchema", "true").saveAsTable("mp3_audio_parser")

print(f"âœ… Saved {filename} to mp3_audio_parser table!")