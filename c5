# CELL 8: FINAL CODE - Real Audio Transcript

from pathlib import Path

# Your MP3 file path
mp3_path = "/Workspace/Users/anuj.b.s@mughalvaren.com/sample-ppt/audio/presentation_script/1_user_say/mygov_1.mp3"

# Get filename
filename = Path(mp3_path).name

print(f"üéµ Processing: {filename}")

# Get real transcript using your transcribe function from earlier cells
try:
    # Use the transcribe_mp3_directly function from your cells 1-7
    real_transcript = transcribe_mp3_directly(mp3_path)
    print("‚úÖ Transcription successful!")
except Exception as e:
    print(f"‚ùå Transcription failed: {e}")
    real_transcript = "Transcription failed - check audio file and Azure configuration"

# Create data
data = [[filename, real_transcript]]
columns = ["filename", "transcript"]

# Create DataFrame
result = spark.createDataFrame(data, columns)

# Show the table (like your image)
display(result)

# Save to your table
result.write.mode("append").saveAsTable("mp3_audio_parser")

print("‚úÖ Real audio transcript saved to mp3_audio_parser table!")