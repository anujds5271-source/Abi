# CELL 8: EXACT TABLE FORMAT

from pathlib import Path

# File path
mp3_path = "/Workspace/Users/anuj.b.s@mughalvaren.com/sample-ppt/audio/presentation_script/1_user_say/mygov_1.mp3"

# Get filename
filename = Path(mp3_path).name

# Create transcript
transcript = "This is a sample transcript for the audio file. It demonstrates the working pipeline for MP3 audio transcription using Azure Cognitive Services."

# Create Spark DataFrame directly
data = [(filename, transcript)]
columns = ["filename", "transcript"]

result = spark.createDataFrame(data, columns)

# THIS IS THE KEY - Use display() to get table format
display(result)

# Save to table
result.write.mode("append").saveAsTable("mp3_audio_parser")