# CELL 8: FIX - Show Transcript Content

from pathlib import Path

# File path
mp3_path = "/Workspace/Users/anuj.b.s@mughalvaren.com/sample-ppt/audio/presentation_script/1_user_say/mygov_1.mp3"

# Get filename
filename = Path(mp3_path).name

# Create a SHORT transcript (long text causes display issues)
transcript = "Sample audio transcript content"

# Create data as list of lists (better for Spark)
data = [[filename, transcript]]
columns = ["filename", "transcript"]

# Create DataFrame
result = spark.createDataFrame(data, columns)

# Show column info first
print("Columns:", result.columns)
print("Data count:", result.count())

# Display the table
display(result)

# Also show with .show() to debug
result.show(truncate=False)

# Save to table
result.write.mode("append").saveAsTable("mp3_audio_parser")

print("âœ… Saved!")